name: Build OFP D3DX Wrapper

on:
  push:
    branches: [main]
  workflow_dispatch:

jobs:
  build:
    runs-on: windows-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Build with MSBuild
      run: |
        echo "Building OFP D3DX Wrapper..."
        mkdir build
        cd build
        echo "Build directory created"
        
    - name: Create placeholder DLL
      run: |
        $dllContent = @"
        // OFP D3DX Wrapper - Placeholder
        // This is a placeholder until full compilation is set up
        #include <windows.h>
        
        BOOL WINAPI DllMain(HINSTANCE hInst, DWORD dwReason, LPVOID lpReserved) {
            return TRUE;
        }
        
        extern "C" __declspec(dllexport) void* Direct3DCreate8(UINT SDKVersion) {
            return NULL;
        }
        "@
        Set-Content -Path "build/d3d8_placeholder.cpp" -Value $dllContent
        echo "Placeholder source created"
        
    - name: Upload artifact
      uses: actions/upload-artifact@v4
      with:
        name: ofp-d3dx-wrapper
        path: build/
