#include <windows.h>
#include <d3d8.h>

// Complete D3D8 interface definitions (extended with implementation)

interface IDirect3D8 : public IUnknown
{
    STDMETHOD(RegisterSoftwareDevice)(void* pInitializeFunction) = 0;
    STDMETHOD_(UINT, GetAdapterCount)() = 0;
    STDMETHOD(GetAdapterIdentifier)(UINT Adapter, DWORD Flags, D3DADAPTER_IDENTIFIER8* pIdentifier) = 0;
    STDMETHOD_(UINT, GetAdapterModeCount)(UINT Adapter) = 0;
    STDMETHOD(EnumAdapterModes)(UINT Adapter, UINT Mode, D3DDISPLAYMODE* pMode) = 0;
    STDMETHOD(GetAdapterDisplayMode)(UINT Adapter, D3DDISPLAYMODE* pMode) = 0;
    STDMETHOD(CheckDeviceType)(UINT Adapter, D3DDEVTYPE CheckType, D3DFORMAT DisplayFormat, D3DFORMAT BackBufferFormat, BOOL Windowed) = 0;
    STDMETHOD(CheckDeviceFormat)(UINT Adapter, D3DDEVTYPE DeviceType, D3DFORMAT AdapterFormat, DWORD Usage, D3DRESOURCETYPE RType, D3DFORMAT CheckFormat) = 0;
    STDMETHOD(CheckDeviceMultiSampleType)(UINT Adapter, D3DDEVTYPE DeviceType, D3DFORMAT SurfaceFormat, BOOL Windowed, D3DMULTISAMPLE_TYPE MultiSampleType) = 0;
    STDMETHOD(CheckDepthStencilMatch)(UINT Adapter, D3DDEVTYPE DeviceType, D3DFORMAT AdapterFormat, D3DFORMAT RenderTargetFormat, D3DFORMAT DepthStencilFormat) = 0;
    STDMETHOD(GetDeviceCaps)(UINT Adapter, D3DDEVTYPE DeviceType, D3DCAPS8* pCaps) = 0;
    STDMETHOD_(HMONITOR, GetAdapterMonitor)(UINT Adapter) = 0;
    STDMETHOD(CreateDevice)(UINT Adapter, D3DDEVTYPE DeviceType, HWND hFocusWindow, DWORD BehaviorFlags, D3DPRESENT_PARAMETERS8* pPresentationParameters, IDirect3DDevice8** ppReturnedDeviceInterface) = 0;
};

interface IDirect3DDevice8 : public IUnknown
{
    STDMETHOD(TestCooperativeLevel)() = 0;
    STDMETHOD_(UINT, GetAvailableTextureMem)() = 0;
    STDMETHOD(ResourceManagerDiscardBytes)(DWORD Bytes) = 0;
    STDMETHOD(GetDirect3D)(IDirect3D8** ppD3D8) = 0;
    STDMETHOD(GetDeviceCaps)(D3DCAPS8* pCaps) = 0;
    STDMETHOD(GetDisplayMode)(D3DDISPLAYMODE* pMode) = 0;
    STDMETHOD(GetCreationParameters)(D3DDEVICE_CREATION_PARAMETERS* pParameters) = 0;
    STDMETHOD(SetCursorProperties)(UINT XHotSpot, UINT YHotSpot, IDirect3DSurface8* pCursorBitmap) = 0;
    STDMETHOD_(void, SetCursorPosition)(int X, int Y, DWORD Flags) = 0;
    STDMETHOD_(BOOL, ShowCursor)(BOOL bShow) = 0;
    STDMETHOD(CreateAdditionalSwapChain)(D3DPRESENT_PARAMETERS8* pPresentationParameters, IDirect3DSwapChain8** pSwapChain) = 0;
    STDMETHOD(GetSwapChain)(UINT iSwapChain, IDirect3DSwapChain8** pSwapChain) = 0;
    STDMETHOD_(UINT, GetNumberOfSwapChains)() = 0;
    STDMETHOD(Reset)(D3DPRESENT_PARAMETERS8* pPresentationParameters) = 0;
    STDMETHOD(Present)(RECT* pSourceRect, RECT* pDestRect, HWND hDestWindowOverride, RGNDATA* pDirtyRegion) = 0;
    STDMETHOD(GetBackBuffer)(UINT BackBuffer, D3DBACKBUFFER_TYPE Type, IDirect3DSurface8** ppBackBuffer) = 0;
    STDMETHOD(GetRasterStatus)(D3DRASTER_STATUS* pRasterStatus) = 0;
    STDMETHOD_(void, SetGammaRamp)(DWORD Flags, CONST D3DGAMMARAMP* pRamp) = 0;
    STDMETHOD_(void, GetGammaRamp)(D3DGAMMARAMP* pRamp) = 0;
    STDMETHOD(CreateTexture)(UINT Width, UINT Height, UINT Levels, DWORD Usage, D3DFORMAT Format, D3DPOOL Pool, IDirect3DTexture8** ppTexture) = 0;
    STDMETHOD(CreateVolumeTexture)(UINT Width, UINT Height, UINT Depth, UINT Levels, DWORD Usage, D3DFORMAT Format, D3DPOOL Pool, IDirect3DVolumeTexture8** ppVolumeTexture) = 0;
    STDMETHOD(CreateCubeTexture)(UINT EdgeLength, UINT Levels, DWORD Usage, D3DFORMAT Format, D3DPOOL Pool, IDirect3DCubeTexture8** ppCubeTexture) = 0;
    STDMETHOD(CreateVertexBuffer)(UINT Length, DWORD Usage, DWORD FVF, D3DPOOL Pool, IDirect3DVertexBuffer8** ppVertexBuffer) = 0;
    STDMETHOD(CreateIndexBuffer)(UINT Length, DWORD Usage, D3DFORMAT Format, D3DPOOL Pool, IDirect3DIndexBuffer8** ppIndexBuffer) = 0;
    STDMETHOD(CreateRenderTarget)(UINT Width, UINT Height, D3DFORMAT Format, D3DMULTISAMPLE_TYPE MultiSample, BOOL Lockable, IDirect3DSurface8** ppSurface) = 0;
    STDMETHOD(CreateDepthStencilSurface)(UINT Width, UINT Height, D3DFORMAT Format, D3DMULTISAMPLE_TYPE MultiSample, IDirect3DSurface8** ppSurface) = 0;
    STDMETHOD(CreateImageSurface)(UINT Width, UINT Height, D3DFORMAT Format, IDirect3DSurface8** ppSurface) = 0;
    STDMETHOD(CopyRects)(IDirect3DSurface8* pSourceSurface, CONST RECT* pSourceRectsArray, UINT cRects, IDirect3DSurface8* pDestinationSurface, CONST POINT* pDestPointsArray) = 0;
    STDMETHOD(UpdateTexture)(IDirect3DBaseTexture8* pSourceTexture, IDirect3DBaseTexture8* pDestinationTexture) = 0;
    STDMETHOD(GetFrontBuffer)(IDirect3DSurface8* pDestSurface) = 0;
    STDMETHOD(SetRenderTarget)(IDirect3DSurface8* pRenderTarget, IDirect3DSurface8* pNewZStencil) = 0;
    STDMETHOD(GetRenderTarget)(IDirect3DSurface8** ppRenderTarget) = 0;
    STDMETHOD(GetDepthStencilSurface)(IDirect3DSurface8** ppZStencilSurface) = 0;
    STDMETHOD(BeginScene)() = 0;
    STDMETHOD(EndScene)() = 0;
    STDMETHOD(Clear)(DWORD Count, CONST D3DRECT* pRects, DWORD Flags, D3DCOLOR Color, float Z, DWORD Stencil) = 0;
    STDMETHOD(SetTransform)(D3DTRANSFORMSTATETYPE State, CONST D3DMATRIX* pMatrix) = 0;
    STDMETHOD(GetTransform)(D3DTRANSFORMSTATETYPE State, D3DMATRIX* pMatrix) = 0;
    STDMETHOD(MultiplyTransform)(D3DTRANSFORMSTATETYPE State, CONST D3DMATRIX* pMatrix) = 0;
    STDMETHOD(SetViewport)(CONST D3DVIEWPORT8* pViewport) = 0;
    STDMETHOD(GetViewport)(D3DVIEWPORT8* pViewport) = 0;
    STDMETHOD(SetMaterial)(CONST D3DMATERIAL8* pMaterial) = 0;
    STDMETHOD(GetMaterial)(D3DMATERIAL8* pMaterial) = 0;
    STDMETHOD(SetLight)(DWORD Index, CONST D3DLIGHT8* pLight) = 0;
    STDMETHOD(GetLight)(DWORD Index, D3DLIGHT8* pLight) = 0;
    STDMETHOD(LightEnable)(DWORD Index, BOOL Enable) = 0;
    STDMETHOD(GetLightEnable)(DWORD Index, BOOL* pEnable) = 0;
    STDMETHOD(SetClipPlane)(DWORD Index, CONST float* pPlane) = 0;
    STDMETHOD(GetClipPlane)(DWORD Index, float* pPlane) = 0;
    STDMETHOD(SetRenderState)(D3DRENDERSTATETYPE State, DWORD Value) = 0;
    STDMETHOD(GetRenderState)(D3DRENDERSTATETYPE State, DWORD* pValue) = 0;
    STDMETHOD(BeginStateBlock)() = 0;
    STDMETHOD(EndStateBlock)(DWORD* pToken) = 0;
    STDMETHOD(ApplyStateBlock)(DWORD Token) = 0;
    STDMETHOD(CaptureStateBlock)(DWORD Token) = 0;
    STDMETHOD(DeleteStateBlock)(DWORD Token) = 0;
    STDMETHOD(CreateStateBlock)(D3DSTATEBLOCKTYPE Type, DWORD* pToken) = 0;
    STDMETHOD(SetClipStatus)(CONST D3DCLIPSTATUS8* pClipStatus) = 0;
    STDMETHOD(GetClipStatus)(D3DCLIPSTATUS8* pClipStatus) = 0;
    STDMETHOD(GetTexture)(DWORD Stage, IDirect3DBaseTexture8** ppTexture) = 0;
    STDMETHOD(SetTexture)(DWORD Stage, IDirect3DBaseTexture8* pTexture) = 0;
    STDMETHOD(GetTextureStageState)(DWORD Stage, D3DTEXTURESTAGESTATETYPE Type, DWORD* pValue) = 0;
    STDMETHOD(SetTextureStageState)(DWORD Stage, D3DTEXTURESTAGESTATETYPE Type, DWORD Value) = 0;
    STDMETHOD(GetSamplerState)(DWORD Sampler, D3DSAMPLERSTATETYPE Type, DWORD* pValue) = 0;
    STDMETHOD(SetSamplerState)(DWORD Sampler, D3DSAMPLERSTATETYPE Type, DWORD Value) = 0;
    STDMETHOD(ValidateDevice)(DWORD* pNumPasses) = 0;
    STDMETHOD(GetInfo)(DWORD DevInfoID, void* pDevInfoStruct, DWORD DevInfoStructSize) = 0;
    STDMETHOD(SetPaletteEntries)(UINT PaletteNumber, CONST PALETTEENTRY* pEntries) = 0;
    STDMETHOD(GetPaletteEntries)(UINT PaletteNumber, PALETTEENTRY* pEntries) = 0;
    STDMETHOD(SetCurrentTexturePalette)(UINT PaletteNumber) = 0;
    STDMETHOD(GetCurrentTexturePalette)(UINT* PaletteNumber) = 0;
    STDMETHOD(SetScissorRect)(CONST RECT* pRect) = 0;
    STDMETHOD(GetScissorRect)(RECT* pRect) = 0;
    STDMETHOD(SetSoftwareVertexProcessing)(BOOL bSoftware) = 0;
    STDMETHOD_(BOOL, GetSoftwareVertexProcessing)() = 0;
    STDMETHOD(SetNPatchMode)(float nSegments) = 0;
    STDMETHOD_(float, GetNPatchMode)() = 0;
    STDMETHOD(DrawPrimitive)(D3DPRIMITIVETYPE PrimitiveType, UINT StartVertex, UINT PrimitiveCount) = 0;
    STDMETHOD(DrawIndexedPrimitive)(D3DPRIMITIVETYPE PrimitiveType, UINT MinVertexIndex, UINT NumVertices, UINT StartIndex, UINT PrimitiveCount) = 0;
    STDMETHOD(DrawPrimitiveUP)(D3DPRIMITIVETYPE PrimitiveType, UINT PrimitiveCount, CONST void* pVertexStreamZeroData, UINT VertexStreamZeroStride) = 0;
    STDMETHOD(DrawIndexedPrimitiveUP)(D3DPRIMITIVETYPE PrimitiveType, UINT MinVertexIndex, UINT NumVertices, UINT PrimitiveCount, CONST void* pIndexData, D3DFORMAT IndexDataFormat, CONST void* pVertexStreamZeroData, UINT VertexStreamZeroStride) = 0;
    STDMETHOD(ProcessVertices)(UINT SrcStartIndex, UINT DestIndex, UINT VertexCount, IDirect3DVertexBuffer8* pDestBuffer, DWORD Flags) = 0;
    STDMETHOD(CreateVertexShader)(CONST DWORD* pDeclaration, CONST DWORD* pFunction, DWORD* pHandle, DWORD Usage) = 0;
    STDMETHOD(SetVertexShader)(DWORD Handle) = 0;
    STDMETHOD(GetVertexShader)(DWORD* pHandle) = 0;
    STDMETHOD(DeleteVertexShader)(DWORD Handle) = 0;
    STDMETHOD(SetVertexShaderConstant)(UINT Register, CONST void* pConstantData, UINT ConstantCount) = 0;
    STDMETHOD(GetVertexShaderConstant)(UINT Register, void* pConstantData, UINT ConstantCount) = 0;
    STDMETHOD(GetVertexShaderDeclaration)(DWORD Handle, void* pData, UINT* pSizeOfData) = 0;
    STDMETHOD(GetVertexShaderFunction)(DWORD Handle, void* pData, UINT* pSizeOfData) = 0;
    STDMETHOD(SetStreamSource)(UINT StreamNumber, IDirect3DVertexBuffer8* pStreamData, UINT Stride) = 0;
    STDMETHOD(GetStreamSource)(UINT StreamNumber, IDirect3DVertexBuffer8** ppStreamData, UINT* pStride) = 0;
    STDMETHOD(SetIndices)(IDirect3DIndexBuffer8* pIndexData, UINT BaseVertexIndex) = 0;
    STDMETHOD(GetIndices)(IDirect3DIndexBuffer8** ppIndexData, UINT* pBaseVertexIndex) = 0;
    STDMETHOD(CreatePixelShader)(CONST DWORD* pFunction, DWORD* pHandle) = 0;
    STDMETHOD(SetPixelShader)(DWORD Handle) = 0;
    STDMETHOD(GetPixelShader)(DWORD* pHandle) = 0;
    STDMETHOD(DeletePixelShader)(DWORD Handle) = 0;
    STDMETHOD(SetPixelShaderConstant)(UINT Register, CONST void* pConstantData, UINT ConstantCount) = 0;
    STDMETHOD(GetPixelShaderConstant)(UINT Register, void* pConstantData, UINT ConstantCount) = 0;
    STDMETHOD(GetPixelShaderFunction)(DWORD Handle, void* pData, UINT* pSizeOfData) = 0;
    STDMETHOD(DrawRectPatch)(UINT Handle, CONST float* pNumSegs, CONST D3DRECTPATCH_INFO* pRectPatchInfo) = 0;
    STDMETHOD(DrawTriPatch)(UINT Handle, CONST float* pNumSegs, CONST D3DTRIPATCH_INFO* pTriPatchInfo) = 0;
    STDMETHOD(DeletePatch)(UINT Handle) = 0;
};